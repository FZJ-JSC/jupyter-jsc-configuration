{% extends "jupyter-jsc.fz-juelich.de/page.html" %}
{% if announcement_spawn %}
{% set announcement = announcement_spawn %}
{% endif %}

{% block stylesheet %}
<link rel="stylesheet" href='{{ static_url("css/pages/spawn.css", include_version=False) }}?v=20210806'
  type="text/css" />
{% endblock %}

{% macro input(name, value) %}
<input id="{{name}}" name="{{name}}" autocomplete="off" value="{{value}}" style="display: None" />
{% endmacro %}

{% macro dropdown(id, function_name) %}
<div id="{{id}}_dropdown" style="display: none; white-space: nowrap;">
  <label for="{{id}}_dropdown_button" id="{{id}}_dropdown_label" class="custom-label">
    {% if id=="option1" %} {{ options_names[0] }} {% endif %}
  </label>
  <div class="dropdown d-inline-block">
    <button id="{{id}}_dropdown_button" name="{{id}}" class="btn custom-button dropdown-toggle form-control"
      data-toggle="dropdown" aria-expanded="false" onchange="{{function_name}}"
      value="{{spawner_options_form.get('dropdown_lists', {})['options'][0]}}">
    </button>
    <div class="dropdown-menu w-100" id="{{id}}_dropdown_menu" aria-labelledby="{{id}}_dropdown_button">
      {% if id=="option1" %}
      {% for option1 in spawner_options_form.get('dropdown_lists',
      {}).get('options', {}).keys() | unique | sort -%}
      <button class="dropdown-item" type="button" onclick="onClickDropdown('{{ option1 }}', 'option1')">{{ option1
        }}</button>
      {% endfor -%}
      {% endif %}
    </div>
  </div>
</div>
{% endmacro %}

{% macro resource_div(id, name, label, min, max, value) %}
<div id="resource_{{id}}_div" style="display: none">
  <label id="resource_{{id}}_label" class="custom-label resource" for="resource_{{id}}_input">
    {{ label }}
  </label>
  <input min="{{min}}" max="{{max}}" value="{{value}}" id="resource_{{id}}_input" name="resource_{{name}}"
    class="custom-input" type="number" />
</div>
{% endmacro %}

{% macro tr(id, text_left, text_right="Value") %}
<tr>
  <td id="reservation_table_{{id}}_left" class="px-3">{{ text_left }}</td>
  <td id="reservation_table_{{id}}_right" class="px-3">{{ text_right }}</td>
</tr>
{% endmacro %}

{% block main %}
<div id="spawn-d1-page" class="row justify-content-around px-md-0 px-lg-4">
  <div id="spawn-options" class="col col-auto">
    {% block heading %}
    <h1 id="optionsheader"></h1>
    {% endblock %}
    <div class="d-flex">
      {% if for_user and user.name != for_user.name -%}
      <p>Spawning server for {{ for_user.name }}</p>
      {% endif -%}
      {% if error_message -%}
      <p class="spawn-error-msg text-danger">Error: {{error_message}}</p>
      {% endif %}
      <form id="spawn_form" role="form" enctype="multipart/form-data" action="{{url}}" method="post">
        <div class="d-none">
          {{ input("vo_active_input", auth_state.get("vo_active")) }}
          {{ input("service_input", service_input) }}
          {{ input("options1_input", "undefined") }}
          {{ input("system_input", "undefined") }}
          {{ input("account_input", "undefined") }}
          {{ input("project_input", "undefined") }}
          {{ input("partition_input", "undefined") }}
          {{ input("reservation_input", "undefined") }}
        </div>

        {% if ( spawner_options_form.get('dropdown_lists', {}).get('options', {}).keys() | length > 0) -%}
        {{ dropdown("option1", "onChangeOption1()") }}
        {{ dropdown("systems", "onChangeSystems()") }}
        {{ dropdown("accounts", "onChangeAccounts()") }}
        {{ dropdown("projects", "onChangeProjects()") }}
        {{ dropdown("partitions", "onChangePartitions()") }}
        {{ dropdown("reservations", "onChangeReservations()") }}

        {{ resource_div("nodes", "Nodes", "Nodes [1, 256]", 1, 256, 1) }}
        {{ resource_div("runtime", "Runtime", "Runtime (min) [1, 1440]", 1, 1440, 30) }}
        {{ resource_div("gpus", "GPUS", "GPUs [1, 4]", 1, 4, 4) }}

        <div id="reservations_checkbox_div" class="card border-dark rounded-0 mb-2" style="display: none;">
          <div class="card-text text-right my-2 mr-4">
            <span class="align-middle">Show reservation info</span>
            <img class="mr-2" id="reservations-checkbox-qm"
              src="https://jupyter-jsc.fz-juelich.de/hub/static/images/qm.png" data-original-title="" title=""
              height="20" />

            <div class="material-switch pull-right">
              <input id="reservations_checkbox_input" name="reservations_checkbox_input" onclick="reservationCB()"
                class="form-control" type="checkbox" />
              <label for="reservations_checkbox_input" class="label-primary mb-1"></label>
            </div>
          </div>
        </div>
  
        <input type="submit" value="Start" class="btn btn-rounded btn-primary form-control" />

        {% elif "message" in spawner_options_form.keys() -%}
        <p> {{ spawner_options_form["message"] }} </p>
        {% else -%}
        <p> No {{ service_input }} available. Systems in maintenace: {{ spawner_options_form.get('maintenance') |
          join(", ") }} </p>
        {% endif -%}
      </div>
    </form>
  </div>

  <div id="reservation-infos" class="col col-auto">
    <h1 style="visibility: hidden">Server Options</h1>
    <div id="reservation_info_empty_div" style="display: none; overflow-x: auto">
      <table class="bg-white">
        <tr>
          <th colspan="2" class="custom-th" style="color: red"> Please choose a reservation </th>
        </tr>
      </table>
    </div>
    <div id="reservation_info_div" style="display: none; overflow-x: auto">
      <table class="bg-white">
        <tr>
          <th colspan="2" class="custom-th" id="reservation_table_name"> Reservation: Name </th>
        </tr>
        {{ tr("state", "State", "INACTIVE") }}
        {{ tr("users", "Users") }}
        {{ tr("accounts", "Accounts") }}
        {{ tr("partition", "PartitionName") }}
        {{ tr("start", "StartTime") }}
        {{ tr("end", "EndTime") }}
        {{ tr("duration", "Duration") }}
        {{ tr("nodescnt", "NodeCnt") }}
        {{ tr("nodes", "Nodes") }}
        {{ tr("corecnt", "CoreCnt") }}
        {{ tr("tres", "TRES") }}
        {{ tr("features", "Features") }}
        {{ tr("flags", "Flags") }}
        {{ tr("licenses", "Licenses") }}
        {{ tr("burstbuffer", "BurstBuffer") }}
        {{ tr("watts", "Watts") }}
      </table>
    </div>
  </div>
</div>
{% endblock %} 



{% block script %}
<script type="text/javascript">
  require(["home"]);
  $(document).ready(function() {
    $("#optionsheader").html("{{ service_input }} Options");
    {% if spawner_options_form.get('dropdown_lists', {}).get('options', []) | length > 0 -%}
      onClickDropdown("{{ spawner_options_form.get('dropdown_lists', {})['options'].keys() | first }}", "option1");
      {% if service_input != "JupyterLab2" or spawner_options_form.get('options', {}).keys() | length > 1 -%}
        $("#option1_dropdown").show();
      {% endif -%}
    {% endif -%}
    return;
  })

  function onClickDropdown(value, id) {
    var old = $("#"+id+"_input").val();
    if (old == value) return;
    //console.log(old, value);
    if (id == "option1") {
      $("#"+id+"_dropdown_button").val(value).trigger("change");
    }
    else $("#"+id+"s_dropdown_button").val(value).trigger("change");
  }

  function _hide_divs() {
    var divs = ["resource_nodes", "resource_runtime", "resource_gpus", "reservations_checkbox",
      "reservation_info_empty", "reservation_info"];
    divs.forEach(function (item, index) {
      $("#" + item + "_div").hide();
    });
    $('#reservations_checkbox_input').prop("checked", false);
  }

  function _hide_and_reset(ids) {
    ids.forEach(function (item, index) {
      if (item == "option1") {
        $("#options1_input").val("undefined");
      } else $("#" + item + "_input").val("undefined");
      $("#" + item + "s_dropdown").hide();
    });
    _hide_divs();
  }

  function onChangeOption1() {
      var option1 = $('#option1_dropdown_button').val();
      _hide_and_reset(["system", "account", "project", "partition", "reservation"]);
      $('#options1_input').val(option1);
      $('#option1_dropdown_button').html(option1);
      {% for option1, systems_allowed in spawner_options_form.get('dropdown_lists', {}).get('options', {}).items() -%}
          if ( option1 == {{ option1 | tojson }} ){
              $('#systems_dropdown_label').html('System');
              $('#systems_dropdown_menu').html("");
              {% set first_element = {'foo': False} %}
              {% for system in spawner_options_form.get('dropdown_lists', {}).get('systems', []) -%}
                {% if system in systems_allowed.keys() -%}
                  {% if not first_element.get("foo") -%}
                    {% if first_element.update({"foo": system}) -%} {% endif -%}
                  {% endif -%}
                $('#systems_dropdown_menu').append('<button class="dropdown-item" type="button" \
                  onclick="onClickDropdown(\'{{system}}\', \'system\')">{{ system }}</button>');
                {% endif -%}
              {% endfor -%}
              $('#systems_dropdown_button').val("{{ first_element.get("foo") }}").trigger("change");
              $('#systems_dropdown').show();
          }
      {% endfor -%} {# option1 -#}
  }
  function onChangeSystems() {
    var option1 = $('#options1_input').val();
    var system = $('#systems_dropdown_button').val();

    _hide_and_reset(["account", "project", "partition", "reservation"]);
    $('#system_input').val(system);
    $('#systems_dropdown_button').html(system);
    {% for option1, systems_allowed in spawner_options_form.get('dropdown_lists', {}).get('options', {}).items() -%}
      {% for system, accounts_allowed in systems_allowed.items() -%}
        {% if spawner_options_form.get('dropdown_lists').get('accounts', {}).get(system, []) | length > 0 -%} 
          if( option1 == {{ option1 | tojson }} && system == {{ system | tojson }} ){
            $('#accounts_dropdown_label').html('Account');
            $('#accounts_dropdown_menu').html("");
            {% set first_element = {'foo': False} %}
            {% for account in spawner_options_form.get('dropdown_lists', {}).get('accounts', {}).get(system, []) | unique | sort -%}
               {% if account in accounts_allowed.keys() -%}
                 {% if not first_element.get("foo") -%}
                   {% if first_element.update({"foo": account}) -%} {% endif -%}
                 {% endif -%}
                 $('#accounts_dropdown_menu').append('<button class="dropdown-item" type="button" \
              onclick="onClickDropdown(\'{{account}}\', \'account\')">{{ account }}</button>');
               {% endif -%}
            {% endfor -%}
            $('#accounts_dropdown_button').val("{{ first_element.get("foo") }}").trigger("change");
            $('#accounts_dropdown').show();
          }
        {% endif -%}
      {% endfor -%}
    {% endfor -%}
  }

  function onChangeAccounts() {
    var option1 = $('#options1_input').val();
    var system = $('#system_input').val();
    var account = $('#accounts_dropdown_button').val();
    
    _hide_and_reset(["project", "partition", "reservation"]);
    $('#account_input').val(account);
    $('#accounts_dropdown_button').html(account);
    {% for option1, systems_allowed in spawner_options_form.get('dropdown_lists', {}).get('options', {}).items() -%}
      {% for system, accounts_allowed in systems_allowed.items() -%}
        {% for account, projects_allowed in accounts_allowed.items() -%}
          {% if spawner_options_form.get('dropdown_lists').get('projects', {}).get(system, {}).get(account, []) | length > 0 -%} 
            if ( option1 == {{ option1 | tojson }} && system == {{ system | tojson }} && account == {{ account | tojson }} ){
              $('#projects_dropdown_label').html('Project');
              $('#projects_dropdown_menu').html("");
              {% set first_element = {'foo': False} %}
              {% for project in spawner_options_form.get('dropdown_lists', {}).get('projects', {}).get(system, {}).get(account, []) | unique | sort -%}
                {% if project in projects_allowed.keys() -%}
                  {% if not first_element.get("foo") -%}
                    {% if first_element.update({"foo": project}) -%} {% endif -%}
                  {% endif -%}
                  $('#projects_dropdown_menu').append('<button class="dropdown-item" type="button" \
                  onclick="onClickDropdown(\'{{project}}\', \'project\')">{{ project }}</button>');      
                {% endif -%}
              {% endfor -%}
              $('#projects_dropdown_button').val("{{ first_element.get("foo") }}").trigger("change");
              $('#projects_dropdown').show();
            }
          {% endif -%}
        {% endfor -%} {# account -#}
      {% endfor -%} {# system -#}
    {% endfor -%} {# option1 -#}
  }

  function onChangeProjects() {
    var option1 = $('#options1_input').val();
    var system = $('#system_input').val();
    var account = $('#account_input').val();
    var project = $('#projects_dropdown_button').val();
    
    _hide_and_reset(["partition", "reservation"]);
    $('#project_input').val(project);
    $('#projects_dropdown_button').html(project);
    {% for option1, systems_allowed in spawner_options_form.get('dropdown_lists', {}).get('options', {}).items() -%}
      {% for system, accounts_allowed in systems_allowed.items() -%}
        {% for account, projects_allowed in accounts_allowed.items() -%}
          {% for project, partitions_allowed in projects_allowed.items() -%}
            {% if spawner_options_form.get('dropdown_lists').get('partitions', {}).get(system, {}).get(account, {}).get(project, []) | length > 0 -%}
              if ( option1 == {{ option1 | tojson }} && system == {{ system | tojson }} && account == {{ account | tojson }} && project == {{ project | tojson }}){
                $('#partitions_dropdown_label').html('Partition');
                $('#partitions_dropdown_menu').html("");
                {% set first_element = {'foo': False} %}
                {% for partition in spawner_options_form.get('dropdown_lists', {}).get('partitions', {}).get(system, {}).get(account, {}).get(project, []) | unique -%}
                  {% if partition in partitions_allowed.keys() -%}
                    {% if not first_element.get("foo") -%}
                      {% if first_element.update({"foo": partition}) -%} {% endif -%}
                    {% endif -%}
                    $('#partitions_dropdown_menu').append('<button class="dropdown-item" type="button" \
                      onclick="onClickDropdown(\'{{partition}}\', \'partition\')">{{ partition }}</button>');
                  {% endif -%}
                {% endfor -%}
                $('#partitions_dropdown_button').val("{{ first_element.get("foo") }}").trigger("change");
                $('#partitions_dropdown').show();
              }
            {% endif -%}
          {% endfor -%} {# project -#}
        {% endfor -%} {# account -#}
      {% endfor -%} {# system -#}
    {% endfor -%} {# option1 -#}
  }
  function onChangePartitions() {
    var option1 = $('#options1_input').val();
    var system = $('#system_input').val();
    var account = $('#account_input').val();
    var project = $('#project_input').val();
    var partition = $('#partitions_dropdown_button').val();
    
    _hide_and_reset(["reservation"]);
    $('#partition_input').val(partition);
    $('#partitions_dropdown_button').html(partition);
    {% set reservations = [] -%}
    {% for option1, systems_allowed in spawner_options_form.get('dropdown_lists', {}).get('options', {}).items() -%}
      {% for system, accounts_allowed in systems_allowed.items() -%}
        {% for account, projects_allowed in accounts_allowed.items() -%}
          {% for project, partitions_allowed in projects_allowed.items() -%}
            {% for partition, reservations_allowed in partitions_allowed.items() -%}
              if ( option1 == {{ option1 | tojson }} && system == {{ system | tojson }} && account == {{ account | tojson }} && project == {{ project | tojson }} && partition == {{ partition | tojson }}){
	        {% if "Nodes" in spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}) -%}
                  $('#resource_nodes_label').html( {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Nodes", {}).get("TEXT", "Nodes") | tojson }});
                  $('#resource_nodes_input').attr({
                    "min": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Nodes", {}).get("MINMAX", [0, 1])[0] }},
                    "max": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Nodes", {}).get("MINMAX", [0, 1])[1] }},
                    "value": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Nodes", {}).get("DEFAULT", 0) }},
                  });
                  $('#resource_nodes_div').show();
                {% endif -%}
                {% if "Runtime" in spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}) -%}
                  $('#resource_runtime_label').html( {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Runtime", {}).get("TEXT", "Runtime") | tojson }});
                  $('#resource_runtime_input').attr({
                    "min": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Runtime", {}).get("MINMAX", [0, 1])[0] }},
                    "max": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Runtime", {}).get("MINMAX", [0, 1])[1] }},
                    "value": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("Runtime", {}).get("DEFAULT", 0) }},
                  });
                  $('#resource_runtime_div').show();
                {% endif -%}
                {% if "GPUS" in spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}) -%}
                  $('#resource_gpus_label').html( {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("GPUS", {}).get("TEXT", "GPUs") | tojson }});
                  $('#resource_gpus_input').attr({
                      "min": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("GPUS", {}).get("MINMAX", [0, 1])[0] }},
                      "max": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("GPUS", {}).get("MINMAX", [0, 1])[1] }},
                      "value": {{ spawner_options_form.get('resources', {}).get(option1, {}).get(system, {}).get(partition, {}).get("GPUS", {}).get("DEFAULT", 0) }},
                  });
                  $('#resource_gpus_div').show();
                {% endif -%}
                {% if reservations_allowed | length > 0 and reservations_allowed != ["None"] -%}
                  $('#reservations_dropdown_label').html('Reservation');
                  $('#reservations_dropdown_menu').html("");
                  {% for reservation in spawner_options_form.get('dropdown_lists', {}).get('reservations', {}).get(system, {}).get(account, {}).get(project, {}).get(partition, []) | unique -%}
                    {% if reservation in reservations_allowed -%}
                      {% if reservation == "None" -%}
                        $('#reservations_dropdown_menu').append('<button class="dropdown-item" type="button" \
                                onclick="onClickDropdown(\'{{reservation}}\', \'reservation\')">{{ reservation }}</button>');
                      {% else -%}
                        {# Check Reservation Info Dict for more information #}
                        {% for reservation_line in spawner_options_form.get('reservations', {}).get(system, []) -%}
                          {% if reservation == reservation_line[0] -%}
                            {% if reservation_line[14] == "INACTIVE" -%}
                              $('#reservations_dropdown_menu').append('<button class="dropdown-item disabled" type="button" style="text-decoration:line-through; color:red" \
                                onclick="onClickDropdown(\'{{reservation}}\', \'reservation\')">{{ reservation }}</button>');
                            {% else -%}
                              $('#reservations_dropdown_menu').append('<button class="dropdown-item" type="button" \
                                onclick="onClickDropdown(\'{{reservation}}\', \'reservation\')">{{ reservation }}</button>');
                            {% endif -%}
                          {% endif -%}
                        {% endfor -%}
                      {% endif -%}
                    {% endif -%}
                  {% endfor -%}
                  $('#reservations_dropdown_button').val("{{reservations_allowed | first}}").trigger("change");
                  $('#reservations_dropdown').show();
                {% endif -%}
              }
            {% endfor -%} {# partitions -#}
          {% endfor -%} {# project -#}
        {% endfor -%} {# account -#}
      {% endfor -%} {# system -#}
    {% endfor -%} {# option1 -#}
  }

  function onChangeReservations() {
    var system = $('#system_input').val();
    var reservation = $('#reservations_dropdown_button').val();
    $('#reservation_input').val(reservation);
    {% for system, reservation_list in spawner_options_form.get("reservations", {}).items() -%}
      if ( system == {{ system | tojson }} ) {
        if (reservation == "None" || reservation == "" || reservation == "undefined" ){
          $('#reservations_dropdown_button').html(reservation);
          $('#reservations_dropdown_button').css("text-decoration", "none").css("color", "black");
        }
        {% for reservation in reservation_list -%}
          if ( reservation == {{ reservation[0] | tojson }} ) {
            $('#reservations_dropdown_button').html({{ reservation[0] | tojson }});
            if ( {{ reservation[14] | tojson }} == "INACTIVE" ) {
              $('#reservations_dropdown_button').css("text-decoration", "line-through").css("color", "red");
              $('#reservation_input').val("None");
            } else {
              $('#reservations_dropdown_button').css("text-decoration", "none").css("color", "black");
              $('#reservation_input').val(reservation);
            }
          }
        {% endfor -%}
      }
    {% endfor -%}
    if ( reservation == "None" || reservation == "" || reservation == "undefined" ) {
      if ( $('#reservations_checkbox_input').is(":checked") ) {
        $('#reservation_info_div').hide();
        $('#reservation_info_empty_div').show();
      }
    } else {
      {% for system, reservation_list in spawner_options_form.get("reservations", {}).items() -%}
        if ( system == {{ system | tojson }} ){
          {% for reservation in reservation_list -%}
            if ( reservation == {{ reservation[0] | tojson }} ){
              if ( "INACTIVE" == {{ reservation[14] | tojson }} ){
                $("#reservation_table_state_left").css("color", "red").css("font-weight", "bold");
                $("#reservation_table_state_right").css("color", "red").css("font-weight", "bold");
              } else {
                $("#reservation_table_state_right").css("color", "black").css("font-weight", "normal");
                $("#reservation_table_state_left").css("color", "black").css("font-weight", "normal");
              }
              $("#reservation_table_name").html( {{ reservation[0] | tojson }} );
              $("#reservation_table_start_right").html( {{ reservation[1] | tojson }} );
              $("#reservation_table_end_right").html( {{ reservation[2] | tojson }} );
              $("#reservation_table_duration_right").html( {{ reservation[3] | tojson }} );
              $("#reservation_table_nodes_right").html( {{ reservation[4] | tojson }} );
              $("#reservation_table_nodescnt_right").html( {{ reservation[5] | tojson }} );
              $("#reservation_table_corecnt_right").html( {{ reservation[6] | tojson }} );
              $("#reservation_table_features_right").html( {{ reservation[7] | tojson }} );
              $("#reservation_table_partition_right").html( {{ reservation[8] | tojson }} );
              $("#reservation_table_flags_right").html( {{ reservation[9] | tojson }} );
              $("#reservation_table_tres_right").html( {{ reservation[10] | tojson }} );
              $("#reservation_table_users_right").html( {{ reservation[11] | tojson }} );
              $("#reservation_table_accounts_right").html( {{ reservation[12] | tojson }} );
              $("#reservation_table_licenses_right").html( {{ reservation[13] | tojson }} );
              $("#reservation_table_state_right").html( {{ reservation[14] | tojson }} );
              $("#reservation_table_burstbuffer_right").html( {{ reservation[15] | tojson }} );
              $("#reservation_table_watts_right").html( {{ reservation[16] | tojson }} );
              if ( $('#reservations_checkbox_input').is(":checked") ) {
                $('#reservation_info_empty_div').hide();
                $('#reservation_info_div').show();
              }
            }
          {% endfor -%}
        }
      {% endfor -%}
    }
    $('#reservations_checkbox_div').show();
  }
  function reservationCB() {
    var reservation = $('#reservations_dropdown_button').val();
    if ( $('#reservations_checkbox_input').is(":checked") ) {
      if ( reservation == "None" || reservation == "undefined" || reservation == "" ){
        $('#reservation_info_div').hide();
        $('#reservation_info_empty_div').show();
      } else {
        $('#reservation_info_div').show();
        $('#reservation_info_empty_div').hide();
      }
    } else {
      $('#reservation_info_div').hide();
      $('#reservation_info_empty_div').hide();
    }
  }
</script>
{% endblock script %}
