{% macro submenu(title, caption_href) %}
{% set id = title.replace('-', '') %}
<li class="dropdown-submenu">
  <a id="navbarNavDropdown{{id}}" href="" aria-haspopup="true" aria-expanded="false" class="dropdown-item">
    {{ title }}
  </a>
  <ul aria-labelledby="navbarNavDropdown{{id}}" class="dropdown-menu dropdown-menu-2">
    {%- for caption, href in caption_href %}
    <li><a class="dropdown-item" target="_blank" href="{{ href }}">
        {# <i class="fa fa-chevron-right" style="color: #004176;"></i> #}
        {{ caption }}</a></li>
    {%- endfor %}
  </ul>
</li>
{% endmacro %}

{% block navbar %}
<nav id="header" class="navbar navbar-top navbar-expand-md navbar-light">
  <div class="container h-100">
    <a class="navbar-brand" href="https://www.fz-juelich.de/jsc" target="_blank">
      <img src='{{ static_url("images/header/jsc.png", include_version=False) }}' alt='Jupyter-JSC' class='jpy-logo'
        title='Home' />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
      aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse align-self-end justify-content-between" id="navbarNavDropdown">
      <ul class="navbar-nav align-self-end mr-4">
        {% block nav_bar_left_items -%}
        <li class="nav-item"><a class="nav-link" href="{{base_url}}home">Start</a></li>
        {% if user.admin -%}
        <li class="nav-item" id="navbarbtn-2"><a class="nav-link" href="{{base_url}}admin">Admin</a></li>
        {% endif -%}
        <li class="nav-item dropdown">
          <a id="navbarNavDropdownLinks" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
            class="nav-link"> Links </a>
          <ul aria-labelledby="navbarNavDropdownLinks" class="dropdown-menu dropdown-menu-1">
            {{ submenu("Jupyter-JSC", [
            ("Presentation",
            "https://docs.jupyter-jsc.fz-juelich.de/github/FZJ-JSC/jupyter-jsc-notebooks/blob/master/Jupyter-JSC_supercomputing-in-the-browser.pdf"),
            ("Extensions at Jupyter-JSC",
            "https://docs.jupyter-jsc.fz-juelich.de/github/FZJ-JSC/jupyter-jsc-notebooks/blob/master/001-Jupyter/List_JupyterExtensions.ipynb"),
            ("Markdown Tips and Tricks",
            "https://docs.jupyter-jsc.fz-juelich.de/github/FZJ-JSC/jupyter-jsc-notebooks/blob/master/001-Jupyter/Markdown_Tipps-and-Tricks.ipynb"),
            ("Setup your own kernel",
            "https://docs.jupyter-jsc.fz-juelich.de/github/FZJ-JSC/jupyter-jsc-notebooks/blob/master/001-Jupyter/Create_JupyterKernel_general.ipynb"),
            ("Setup your own kernel with conda",
            "https://docs.jupyter-jsc.fz-juelich.de/github/FZJ-JSC/jupyter-jsc-notebooks/blob/master/001-Jupyter/Create_JupyterKernel_conda.ipynb"),
            ("Jupyter-JSC at unicore.eu", "https://www.unicore.eu/about-unicore/case-studies/jupyter-at-jsc/")
            ]) }}

            {{ submenu("Jupyter", [
            ("Home", "https://www.jupyter.org"),
            ("Newsletter", "https://newsletter.jupyter.org"),
            ("Introduction Video", "https://www.youtube.com/watch?v=HW29067qVWk"),
            ("Blog", "https://blog.jupyter.org"),
            ("Documentation", "https://jupyter.org/documentation.html"),
            ("Twitter", "https://twitter.com/projectjupyter"),
            ("Jupyter-Notebooks", "https://github.com/trending/jupyter-notebook"),
            ("Jupyter Gitter", "https://gitter.im/jupyter/jupyter"),
            ("JupyterLab Gitter", "https://gitter.im/jupyterlab/jupyterlab")
            ]) }}

            {{ submenu("JSC", [
            ("JUWELS", "https://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUWELS/JUWELS_node.html"),
            ("JURECA", "https://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JURECA/JURECA_node.html"),
            ("JUSUF", "https://fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUSUF/JUSUF_node.html"),
            ("DEEP", "https://fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/DEEP-EST/_node.html"),
            ("Newsletter", "https://www.fz-juelich.de/ias/jsc/EN/News/Newsletter/newsletter_node.html"),
            ("Events", "https://www.fz-juelich.de/ias/jsc/EN/News/Events/events_node.html"),
            ("Twitter", "https://twitter.com/fzj_jsc")
            ]) }}
          </ul>
        </li>
        {% endblock -%}
      </ul>

      <div class="navbar-nav my-2">
        {% block nav_bar_right_items -%}
        {% block login_widget -%}
        <div id="login_widget">
          {% if user and show_login -%}
          {% if auth_state and auth_state.get("last_login", False) -%}
          <p>Last login: {{ auth_state.get("last_login") }}</p>
          {% endif -%}
          <div class="row mb-sm-2 mb-md-0">
            <span class="col align-self-center">{{ user.name }}</span>
            {% set vo_available = auth_state.get("vo_available", []) %}
            {% set vo_active = auth_state.get("vo_active", '' ) %}
            {% if vo_available|length > 1 -%}
            <div class="col-auto">
              <div class="input-group input-group-sm">
                <div class="input-group-prepend">
                  <label class="input-group-text font-weight-bold" for="vo-select">Group (<a
                      href="/hub/groups">?</a>):</label>
                </div>
                <select id="vo-select" class="custom-select" style="border-radius: 0.2em !important">
                  {% for vo in vo_available -%}
                  {% if vo == vo_active %}
                  <option selected>{{vo}}</option>
                  {% else %}
                  <option>{{vo}}</option>
                  {% endif %}
                  {% endfor -%}
                </select>
                <a id="logout" role="button" class="btn btn-sm btn-default ml-1">
                  <i aria-hidden="true" class="fa fa-sign-out"></i>
                  Logout
                </a>
              </div>
            </div>
            {% else -%}
            <div class="col-auto">
              <div class="input-group input-group-sm">
                <a id="logout" role="button" class="btn btn-sm btn-default ml-1">
                  <i aria-hidden="true" class="fa fa-sign-out"></i>
                  Logout
                </a>
              </div>
            </div>
            {% endif -%}
            {% endif -%}
            {% endblock -%}
            {% endblock -%}
          </div>
        </div>
      </div>
    </div>
</nav>
{% endblock %}
